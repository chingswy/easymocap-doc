---
layout: default
title: 半圈场景设置
parent: 相机标定
grand_parent: 实用工具
---

# 半身动捕工作环境

## 相机设置

在六个相机的情况，推荐配置
0. 手机竖着还是横着，如果相机拍下来的图像人不是竖直的话，需要确保不同视角下的保持一致，例如都往同一个方向旋转90度。
1. 在正对人的中间位置高低放置两个相机
2. 低的位置位于1米处，高的位于2米处，需要俯视。
3. 两侧每边两个相机，相邻两个相机与圆心的连线的夹角大约在30度。
4. 侧面的视野，尽量只看到绿幕范围，人的两手中等展开要不超出屏幕
5. 侧面的视野不一定两只手都要能看到，但要能看到一只手。
6. 侧面的靠近中间的两个相机，要求都要把人放在中心，并且手在中等范围内需要能看全。

<div align="center">
    <img src="./halfstudio/halfstudio.jpg" width="60%">
    <br><sup>相机位置设置</sup>
</div>

## 标定数据采集

如果使用棋盘格标定，需要采集3组数据，整个采集过程的注意事项有：
- 采数据时需要标定的相机需要看到棋盘格的所有角点（棋盘格的天然缺陷）
- 棋盘格尽量越大越好，尽量不要发生形变
- 如果棋盘格比较软的话，拿着短的一边，缓慢移动，不要用力晃
- 棋盘格不要正对着相机，需要有各个角落的倾斜
- 拍摄过程移动不要太快，避免出现运动模糊和相机不同步导致的误差

### 1. 内参标定

<div align="center">
    <img src="https://raw.githubusercontent.com/chingswy/Dataset-Demo/main/EasyMocap/calib_intri.jpg" width="80%">
    <br>
    <sup>内参数据：让棋盘格在相机视野范围内移动</sup>
</div>

注意事项：
- 标定需要棋盘格所有角点都可见
- 在标定开始的时候，确定最近的距离与图像的边界，在边界范围内移动
- 标定需要覆盖几个不同的距离，在每个距离下，包含图像视野范围的各个部分的数据
- 图像的每个角落的范围都要覆盖到，四个角落都要覆盖到
- 在主要工作区域，需要多采样一些，棋盘格横着和竖着都要，角度尽量大一些
- 使用100张图像大概需要5分钟；使用200张图像大概需要2小时；使用400张图像大概需要10小时；推荐多采一些然后再采样出一些图像来使用

### 2. 外参标定

<div align="center">
    <img src="https://raw.githubusercontent.com/chingswy/Dataset-Demo/main/EasyMocap/calib_extri.jpg" width="80%">
    <br>
    <sup>地面信息：将棋盘格放置到地面，确保每一个相机（尽可能多的相机）都能看到。接着抓取一帧图片，如图所示。</sup>
</div>

注意事项：
- 有棋盘格的可以使用棋盘格放在地面
- 如果放到地面无法保证都可见的话，那么可以把棋盘格贴在墙面上，或者放到一个已知高度的椅子上
- 没有棋盘格的有地面的可以在地面上挑一些地砖格子都没有的手动贴胶带与标志点，控制长度
- 如果没有都能看到的位置，那么就放在想要的地面上就好，只需要尽可能多的相机能看到，后面在使用全局的匹配点进行BA优化相机

### Bundle Adjustment

<div align="center">
    <img src="../../images/calibration/match_img.jpg" width="80%">
    <br>
    <sup>多视角优化：将棋盘格举在手中进行移动，尽量使得3个相机能够同时看到</sup>
</div>

注意事项：
- 拍摄的时候将棋盘格举在手中进行移动
- 每个时刻尽量让3个以上相机同时观测到完整的棋盘格
- 侧面的视角可以多录一些
- 如果使用动态棋盘格但相机同步性较差，建议将棋盘格固定住后，静止拍摄再移动到下一位置，再静止拍摄；重复该步骤
- 如果没有棋盘格，人站在相机前将手指伸开，保持静止不动，然后换一些位置，将手指伸开，继续保持不动，这样重复

### 人体关键点检验

注意事项：
- 录一段人体在相机面前的


## 标定数据处理

见相机标定部分。

## 数据采集

### 1. 测试数据

1. 两手放到胸前，手势不动，转圈 => 测试身体重建
2. 两手放到胸前，身体保持不动，手腕旋转 => 测试手腕重建
3. 身体与手腕一起运动 => 测试身体与手腕
4. 身体与手腕不动，做手势 => 测试手部姿态估计
